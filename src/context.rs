use core::arch::global_asm;

#[repr(C, align(8))]
#[derive(Clone, Copy)]
pub struct RegisterContext {
    pub ra: u64,
    pub sp: u64,
    pub gp: u64,
    pub tp: u64,
    pub t0: u64,
    pub t1: u64,
    pub t2: u64,
    pub s0: u64,
    pub s1: u64,
    pub a0: u64,
    pub a1: u64,
    pub a2: u64,
    pub a3: u64,
    pub a4: u64,
    pub a5: u64,
    pub a6: u64,
    pub a7: u64,
    pub s2: u64,
    pub s3: u64,
    pub s4: u64,
    pub s5: u64,
    pub s6: u64,
    pub s7: u64,
    pub s8: u64,
    pub s9: u64,
    pub s10: u64,
    pub s11: u64,
    pub t3: u64,
    pub t4: u64,
    pub t5: u64,
    pub t6: u64,
    pub ft0: u64,
    pub ft1: u64,
    pub ft2: u64,
    pub ft3: u64,
    pub ft4: u64,
    pub ft5: u64,
    pub ft6: u64,
    pub ft7: u64,
    pub fs0: u64,
    pub fs1: u64,
    pub fa0: u64,
    pub fa1: u64,
    pub fa2: u64,
    pub fa3: u64,
    pub fa4: u64,
    pub fa5: u64,
    pub fa6: u64,
    pub fa7: u64,
    pub fs2: u64,
    pub fs3: u64,
    pub fs4: u64,
    pub fs5: u64,
    pub fs6: u64,
    pub fs7: u64,
    pub fs8: u64,
    pub fs9: u64,
    pub fs10: u64,
    pub fs11: u64,
    pub ft8: u64,
    pub ft9: u64,
    pub ft10: u64,
    pub ft11: u64,
}

#[repr(C)]
#[derive(Clone, Copy)]
pub struct ActivationResult {
    pub pc: u64,
    pub cause: u64,
}

impl RegisterContext {
    pub const fn all_zero() -> RegisterContext {
        RegisterContext {
            ra: 0,
            sp: 0,
            gp: 0,
            tp: 0,
            t0: 0,
            t1: 0,
            t2: 0,
            s0: 0,
            s1: 0,
            a0: 0,
            a1: 0,
            a2: 0,
            a3: 0,
            a4: 0,
            a5: 0,
            a6: 0,
            a7: 0,
            s2: 0,
            s3: 0,
            s4: 0,
            s5: 0,
            s6: 0,
            s7: 0,
            s8: 0,
            s9: 0,
            s10: 0,
            s11: 0,
            t3: 0,
            t4: 0,
            t5: 0,
            t6: 0,
            ft0: 0,
            ft1: 0,
            ft2: 0,
            ft3: 0,
            ft4: 0,
            ft5: 0,
            ft6: 0,
            ft7: 0,
            fs0: 0,
            fs1: 0,
            fa0: 0,
            fa1: 0,
            fa2: 0,
            fa3: 0,
            fa4: 0,
            fa5: 0,
            fa6: 0,
            fa7: 0,
            fs2: 0,
            fs3: 0,
            fs4: 0,
            fs5: 0,
            fs6: 0,
            fs7: 0,
            fs8: 0,
            fs9: 0,
            fs10: 0,
            fs11: 0,
            ft8: 0,
            ft9: 0,
            ft10: 0,
            ft11: 0,
        }
    }
}

extern "C" {
    pub fn activate_context(pc: u64, context_base: u64, hart_id: u64) -> ActivationResult;
    pub fn init_context();
}

global_asm!(include_str!("context.S"));
